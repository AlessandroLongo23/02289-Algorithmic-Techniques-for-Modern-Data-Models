## Vanilla Graph Streaming
In graph streaming, the stream consists of edges of $E$ for a graph $G=(V,E)$. Each edge of $E$ occurs exactly once in the stream.
$V=[n]$ and $n$ is known by the algorithm.
This is known as **vanilla** or **insertion-only** graph stream.
We let $m=|E|$ be the stream length.
We allow space $O(n(\log(n))^c)$, with constant $c$ ("semi-streaming" algorithm).
One exception is our spanner algorithm at the end of the lecture.
### Graph Connectivity
Let's assume that $G$ is an undirected graph. The problem is to determine if $G$ is connected.
This is easy with $O(m+n)$ words of space, but we will give an algorithm using only $O(n\log(n))$ bits of space, which is close to a lower bound of $\Omega(n)$ bits.
### Spanning tree and Spanning forest
A spanning tree of a connected graph $G=(V,E)$ is a tree in $G$ with vertex set $V$.
![[Spanning tree.png]]
A spanning forest of a graph $G=(V,E)$ consists of a spanning tree for each connected component of $G$.
![[Spanning forest.png]]
If $G$ is connected, any spanning forest of $G$ is a spanning tree of $G$.
Any spanning tree of a connected $k$-vertex graph has $k-1$ edges.
Thus, $G$ is connected $\iff$ any spanning forest of $G$ has $n-1$ edges.
### Algorithm
```
proc connectivity(S):
	F = {}
	connected = false
	
	for edge of S:
		if F + edge has no cycle:
			F = F + edge
			if |F| = n-1:
				connected = true
	
	output connected
```
### Correctness and complexity
$F$ is the edges of a spanning forest of the part of $G$ seen so far.
At termination $|F|=n-1\iff G$ is connected.
The space used is dominated by $|F|$, but since $|F|\le n-1$, the algorithm uses $O(n)$ words of space, which is $O(n\log(n))$ bits.
### Bipartiteness testing
#### Definition
An undirected graph $G=(V,E)$ is bipartite if there is a partition $(L,R)$ of $V$ where each edge has one endpoint in $L$ and one in $R$. It's equivalent to saying that $G$ is $2$-colorable.
![[]]
We'll give an algorithm for bipartiteness testing, i.e., determine whether a graph is bipartite.
#### Even and odd cycles
A cycle is odd if it has an odd number of edges, otherwise it is even.
An even cycle can be $2$-colored; an odd cycle cannot.
![[]]
#### Algorithm
```
proc bipartiteness_testing(S):
	F = {}
	is_bipartite = true
	for {u,v} in S:
		if F + {u,v} has no cycle:
			F = F + {u,v}
		else if F + {u,v} has an odd cycle:
			is_bipartite = false
	
	output is_bipartite
```
The space consumption is dominated by $|F|$, which at any point in the algorithm is a forest.
Thus, the space in bits is $O(n\log(n))$.
#### Correctness
Assume first that the algorithm returns false: we want to show that $G$ is not bipartite.
When processing some $\{u,v\}\in E,F\cup\{\{u,v\}\}$ contained an odd cycle, which cannot be $2$-colored. This odd cycle is in $G$, so $G$ is not bipartite.
Now, assume that true is returned: we want to show that $G$ is $2$-colorable.
Let $K:[n]\to\{0,1\}$ be a $2$-coloring of forest $F$. We will show that for any $\{u,v\}\in E,K(u)\ne K(v)$.
This is clear if $\{u,v\}\in F$, so assume $\{u,v\}\notin F$.
Let $P_{uv}$ be the path from $u$ to $v$ in $F$.
$C_{uv}=P_{uv}\cup\{\{u,v\}\}$ is a cycle in $G$.
When $\{u,v\}$ was processed, it reached the else case.
If the algorithm returns true means that $C_{uv}$ is even, and so $K(u)\ne K(v)$.
![[]]
### Distance estimation
#### Definition
We're given an undirected unweighted graph $G=(V,E)$ and a parameter $t\ge 1$, and we define $\delta_G(u,v)$ as the shortest path distance between $u$ and $v$ in $G$.
The distance estimation consists of returning, given a query vertex pair $(u,v)$, a stretch $t$ estimate $\hat\delta_G(u,v)$ of $\delta_G(u,v)$ such that:
$$\delta_G(u,v)\le\hat\delta_G(u,v)\le t\cdot\delta_G(u,v)$$
A $t$-spanner of $G$ is a subgraph $H$ such that for all $u,v\in V$:
$$\delta_H(u,v)\le t\cdot\delta_G(u,v)$$
Since $H$ is a subgraph of $G$, we also have $\delta_G(u,v)\le\delta_H(u,v)$.
Our distance estimation algorithm maintains a $t$-spanner, and the queries are answered by simply running BFS in the $t$-spanner.
#### $t$-spanner edge property
Let $H$ be a subgraph of $G=(V,E)$ and let $t\ge1$.
$H$ has the $t$-spanner edge property if, for all $\{u,v\}\in E$:
$$\delta_H(u,v)\le t$$
![[]]
$H$ is a $t$-spanner of $G\iff H$ has the $t$-spanner edge property.
#### Proof
$\implies$: $\{u,v\}\in E\implies\delta_G(u,v)=1\implies\delta_H(u,v)\le t$
$\impliedby$: Assume $H$ has the $t$-spanner edge property and let $u,v\in V$. Let $P_{uv}$ be a shortest path in $G$ (trivial if $P_{uv}$ doesn't exist). For any edge $\{a,b\}$ of $P_{uv}$, we have $\delta_H(a,b)\le t$. Thus, $H$ has a path from $a$ to $b$ of length at most $t\cdot|P_{uv}|=t\cdot\delta_G(u,v)$.
![[]]
#### Algorithm
```
proc t_spanner(S):
	H = {}
	for {u,v} in S:
		if delta_H(u,v) >= t+1:
			H = H + {u,v}

proc query(u,v):
	delta_H(u,v) 
```
#### Correctness
When an edge $e=\{u,v\}$ is processed, either:
- $e$ was added to $H$
- $\delta_H(u,v)\le t$

In both cases, $\delta_H(u,v)\le t$ after $e$ is processed.
This also holds at any later point, as edges are not removed from $H$.
The $t$-spanner edge property implies that $H$ is a $t$-spanner of processed edges, so at termination $H$ is a $t$-spanner of $G$.
#### Girth of a graph
The girth $\gamma(H)$ of a graph $H$ is the length of its shortest cycle. If $H$ is acyclic, we define $\gamma(H)=\infty$.
#### Space complexity
The space consumption is $O(|E(H)|\log(n))$ bits. It can be shown that $\gamma(H)\ge t+2$. We will use this to bound $|E(H)|$.
```ad-Teorema
title: Theorem
Given an undirected graph $H$ with $m$ edges and $n$ vertices. Let $k\ge 2$ be an integer such that $\gamma(H)\ge k$. Then:

$$m\le n+n^{1+1/\lfloor(k-1)/2\rfloor}$$
```
```ad-Dimostrazione
title: Proof
Let $d$ denote the average degree in $H$.
Note that $\sum_{v\in V}\deg_H(v)=2m$ since each edge is counted twice.
Thus, $d=\dfrac{2m}n$.
Construct a subgraph $F$ of $H$ by removing vertices of degree $lt\dfrac d2$.
By construction, $F$ has a minimum degree at least $\dfrac d2$.
Since $F$ is a subgraph of $H$, $\gamma(F)\ge\gamma(H)\ge k$.
![[]]
Let $l=\left\lfloor\dfrac{k-1}2\right\rfloor$ and $u\in V$.
Let $B_u=(V_u,E_u)$ be the subgraph of $F$ visited by a BFS search from $u$ up to distance $l$:
- $V_u=\{v\in V|\delta_F(u,v)\le l\}$
- $E_u=\{(u,w)\in E(F)|\min\{\delta_F(u,v),\delta_F(u,w)\}\le l-1\}$

![[]]
$B_u$ is connected as it contains a BFS tree $T$. We want to show that $B_u=T$.
Assume for contradiction that $B_u$ has an edge $(v,w)$ not in $T$.
![[]]
Recall that:
$$E_u=\{(u,w)\in E(F)|\min\{\delta_F(u,v),\delta_F(u,w)\}\le l-1\}$$
Since $l=\left\lfloor\dfrac{k-1}2\right\rfloor$, then $B_u$ has a cycle of length at most:
$$\delta_T(u,v)+\underbrace{\delta_{B_u}(v,w)}_{=1}+\delta_T(w,u)\le(l-1)+1+l=2l\lt k$$
But then, $\gamma(B_u)\lt k$, contradicting that $\gamma(B_u)\ge\gamma(F)\ge k$.

$F$ has minimum degree at least $\dfrac d2$, so each non-leaf vertex in $B_u$ has at least $\dfrac d2-1$ children.
![[]]
If $n'$ is the number of vertices at distance $l$ from $u$ in $B_u$:
$$n\ge n'=\left(\dfrac d2-1\right)^l=\left(\dfrac{2m/n}2-1\right)^l=\left(\dfrac mn-1\right)^l$$
Isolating $m$ shows the theorem:
$$n\ge\left(\dfrac mn-1\right)^l\iff n^{1/l}\ge\dfrac mn-1\iff n^{1+1/l}\ge m-n$$
```
For the graph $H$ in our algorithm, $\gamma(H)\ge t+2$, so substituting it in the theorem, we get:
$$O\left(n^{1+1/\lfloor(t+1)/2\rfloor}\right)=O\left(n^{1+2/t}\right)$$
So the bits of space used by the algorithm are:
$$O\left(n^{1+2/t}\log(n)\right)$$
- - -