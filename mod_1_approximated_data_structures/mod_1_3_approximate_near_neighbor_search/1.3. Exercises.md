## Exercise 1: Hamming Distance
### Problem
Let $P$ be a set of $n$ bit vectors of length $d$. Give a data structure (for Hamming distance) for which $\texttt{Insert}$ can be implemented in $O(1)$ time and $\texttt{NearestNeighbor}$ in $O(nd)$ time.
### Solution

- - -
## Exercise LSH Hamming Distance
### Problem
Let $T_1,T_2$ be hash tables of size $5$ with hash functions:
- $h_1(x)=(3x+4)\text{ mod }5$
- $h_2(x)=(7x+2)\text{ mod }5$

Let:
- $g_1(x)=x_1x_4x_8$
- $g_2(x)=x_1x_7x_7$

Insert the bit strings:
- $x=10110011$
- $y=00110010$
- $u=01001010$
- $v=01001000$

and draw the hash tables.
Compute the results of $\texttt{ApxNearNeighbor}(10111010)$.
### Solution
See code
- - -
## Exercise 3: $c$-Approximate Closest Pair under Hamming Distance
### Problem
Assume you have a data structure bit vectors for which $\texttt{Insert}$ and $\texttt{ApxNearestNeighbor}$ run in time $T(n)$. The distance metric is the Hamming distance, $n$ is the number of bit string in the data structure, and $\texttt{ApxNearestNeighbor}(x)$ returns a point no more than $c\cdot\min_{x\in P}d(x,z)$ away from $x$.
Give an algorithm that given a set $P$ of $n$ bit vectors each of length $d$ finds a pair $x,y$ of distinct strings in $P$ in time $O(T(n)\cdot n+dn)$ such that $d(x,y)\le c\cdot\min_{u,v\in P,u\ne v}d(u,v)$.
### Solution

- - -
## Exercise 4: Hamming Distance Analysis
### Problem
From the proof of Claim 1 on the slides: Prove that $Lp_1^k\ge 2$.
*Hint: recall that $k=\dfrac{log_2(n)}{\log_2(1/p_2)}$*
### Solution

- - -
## Exercise 5: Hamming Distance Analysis 2
### Problem
In this exercise we will analyze the LSH scheme for Hamming Distance. Recall that in a query we stop after we have checked $6L+1$ strings. Let $F=\{y\in P:d(x,y)\gt cr\}$ (strings far from $x$) and let $z^*$ be a fixed string with $d(x,z^*)\le r$. We say that $y$ collides with $x$ if $g_j(x)=g_j(y)$ for some $i\in\{1,\ldots,L\}$.
#### Part 1
Explain why it is enough to prove that the following two properties hold:
1. the number of strings in $F$ that collides with $x$ are at most $6L$
2. $z^*$ collides with $x$
#### Part 2
Let $y$ be a string in $F$. Prove that:
$$P[y\text{ collides with }x\text{ in }T_j]\le\dfrac1n$$
```ad-hint
title: Hint
Recall that $k=\dfrac{\log(n)}{\log(1/p_2)}$
```
#### Part 3
Let $X_{y,j}=1$ if $y$ collides with $x$ in $T_j$ and $0$ otherwise, and let
$$X=\sum_{y\in F}\sum_{j=1}^LX_{y,j}$$
Prove that $\mathbb E[X]\le L$.
#### Part 4
Use Markov's inequality to show that $P[X\gt 6L]\lt\dfrac16$
#### Part 5
Prove that if there exists a string $z^*$ in $P$ with $d(x,z^*)\le r$, then with probability at least $\dfrac23$ we will return some $y$ in $P$ for which $d(x,y)\le cr$.
### Solution
#### Part 1

#### Part 2

#### Part 3

#### Part 4

#### Part 5

- - -
## Exercise 6: Jaccard distance and Sim Hash
### Problem
The Jaccard similarity of two sets is defined as $J_\text{SIM}(A,B)=\dfrac{|A\cap B|}{|A\cap B|}$. In MIn-Hash you pick a random permutation $\pi$ of the elements in the universe and let $h(A)=\displaystyle\min_{a\in A}\pi(a)$.
#### Part 1
Let:
- $S_1=\{a,e\}$
- $S_2=\{b\}$
- $S_3=\{a,c,e\}$
- $S_4=\{b,d,e\}$

Compute the Jaccard similarity of each pair of sets.
#### Part 2
Let $S_1,\ldots,S_4$ be as above and let the random permutation be $(b,d,e,a,c)$, i.e., $\pi(a)=4$, $\pi(b)=1$, etc.
Compute the min-hash value of each of the sets.
#### Part 3
Prove that the probability that the min-hash of two sets is equal to the Jaccard similarity of the two set, i.e., that $P[h(A)=h(B)]=\dfrac{|A\cap B|}{|A\cup B|}$
#### Part 4
The Jaccard distance is defined as $d_J(a,b)=1-J_\text{SIM}(A,B)$. Show that the Jaccard distance is a metric. That is, show that:
- $d_J(A,B)\ge 0$ for all sets $A$ and $B$
- $d_J(A,B)=0$ if and only if $A=B$
- $d_J(A,B)=d_J(B,A)$
- $d_J(A,B)\le d_J(A,C)+d_J(C,B)$ for all sets $A$, $B$ and $C$

```ad-hint
title: Hint
For the last point use $P[h(A)=h(B)]=\dfrac{|A\cap B|}{|A\cup B|}$
```
### Solution
#### Part 1
See code
#### Part 2
See code
#### Part 3

#### Part 4

- - -